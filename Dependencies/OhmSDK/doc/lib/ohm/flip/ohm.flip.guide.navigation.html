<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Flip Programming Guide: Navigating the Model</title>
<link rel="stylesheet" href="docpage.css" type="text/css" />
</head>

<script type="text/javascript">
function searchfield_focus(obj)
{
obj.style.color="#000"
if (obj.value=="Search Library")
	{obj.value=""}
}
</script>


<body>

<div id="header">
<div style="width: 1006px;">
<!--<form method="get" class="search" style="padding-top: 5px;"  action="http://www.google.com/search">
<input onfocus="searchfield_focus(this)" type="search" class="search" name="q" value="Search Library">
<input type="hidden" name="sitesearch" value="">
</form>-->
</div>
<p><a href="index.html">Ohm Force Developer Library</a><a href="ohm.flip.guide.about.html">Flip Programming Guide</a></p>
</div>

<div id="toc">
<p>Flip Programming Guide</p>
<ul>
<li><a href="ohm.flip.guide.about.html">About Flip Programming Guide</a></li>
<li><a href="ohm.flip.guide.design.html">Designing your Flip Application</a></li>
<li><a href="ohm.flip.guide.class.html">Writing a Flip Class Part 1</a></li>
<li><a href="ohm.flip.guide.class2.html">Writing a Flip Class Part 2</a></li>
<li><a href="ohm.flip.guide.containers.html">Using Containers</a></li>
<li><a href="ohm.flip.guide.enums.html">Using Enums</a></li>
<li><a href="ohm.flip.guide.blob.html">Using Blobs</a></li>
<li><a href="ohm.flip.guide.objectref.html">Using ObjectRefs</a></li>
<li><a href="ohm.flip.guide.cue.html">Using Cues</a></li>
<li><a href="ohm.flip.guide.navigation.html"><strong>Navigating the Model</strong></a>
	<ul>
	<li><a href="ohm.flip.guide.navigation.html#overview">Overview</a></li>
	<li><a href="ohm.flip.guide.navigation.html#children">Visiting Children</a></li>
	<li><a href="ohm.flip.guide.navigation.html#ancestor">Visiting Ancestors</a></li>
	</ul>
</li>
<li><a href="ohm.flip.guide.observer.html">Writing a DocumentObserver</a></li>
<li><a href="ohm.flip.guide.validator.html">Writing a DocumentValidator</a></li>
<li><a href="ohm.flip.guide.undo.html">Using the Undo/Redo system</a></li>
<li><a href="ohm.flip.guide.const.html">Managing Pseudo Const Members</a></li>
<li><a href="ohm.flip.guide.mold.html">Using an ObjectMold</a></li>
<li><a href="ohm.flip.guide.conversion.html">Writing a Converter</a></li>
<li><a href="ohm.flip.guide.tweaker.html">Writing a DocumentTweaker</a></li>
</ul>

<div class="bottomspacer">&nbsp;</div>
</div>

<div id="content">

<div class="nav" align="right"><a href="ohm.flip.guide.cue.html">previous</a><span>&nbsp;</span><a href="ohm.flip.guide.observer.html">next</a></div>

<h1>Navigating the Model</h1>

<p>This chapter will describe how to navigate the model that is either
visit an object children or parent.</p>
<h2><a name="overview">Overview</a></h2>
<p>Using the Flip framework, the model is implicitely a tree, that is,
each object has exactly one parent, except root which has no parent.</p>
<p>The model tree can be navigated, parsed using the Flip framework when
handling a model change, or when controlling the model.</p>
<p>The following sections will show how to first visit children, then
to visit a parent or more generally ancestors.</p>
<h2><a name="children">Visiting Children</a></h2>
<p>Children of an object are always in containers. The containers themselves defines
iterators and reverse iterators to visit children.</p>
<p>However the iterators are a bit different from the ones defined in the standard
library. Since the containers support the property of holding simulatenously
two revision of the model (the previous revision and the current revision), it
was decided for the iterator to support this special property by allowing
them to know how the container should be iterated.</p>
<p>In practice, objects in a container can have exactly 3 states :</p>
<ul>
<li>Added: compared to the previous revision, an object was added to the container
</li>
<li>Resident: compared to the previous revision, the object was neither added or removed
</li>
<li>Removed: compared to the previous revision, an object was removed from the container
</li>
</ul>
<div class="note"><p><strong>Note:</strong>Outside of a
<span class="code">document_changed</span> 
all objects in a container are resident.</p></div>
<p>The iteration property is defined as the ability to only iterate over a set of defined states
in the container. This property is then injected in the iterator, and the iterator is
then used as usual.</p>
<p>In practice the iterator is constructed with a
<span class="code">FindMask</span> 
constant. Also in practice,
only two of the
<span class="code">FindMask</span> 
are used and defined in the sub-sections below.</p>
<div class="codeblock">
<p><strong>Listing</strong>Example of iterator property injection
</p>
<table>
<tr><td><pre>MyArray::iterator it = my_array.begin (flip::FindMask_NATURAL);</pre></td></tr>
<tr><td><pre>MyArray::iterator it2 = my_array.begin (flip::FindMask_CUR);</pre></td></tr>
</table>
</div>
<h3><a name="children.natural">FindMask_NATURAL</a></h3>
<p>The
<span class="code">flip::FindMask_NATURAL</span> 
is the most used property for iterators. Therefore
it is always the default parameter value for Flip methods taking a
<span class="code">flip::FindMask</span> 
parameter.</p>
<p>When injected from a
<span class="code">document_changed</span> 
the iterator will have the property of
iterating over all the elements states, and in particular objects which are going to be
removed after the
<span class="code">document_changed</span> 
call.</p>
<p>When injected outside a
<span class="code">document_changed</span> 
the iterator will have the property
of iterating over all the elements (which are all residents)</p>
<h3><a name="children.natural">FindMask_CUR</a></h3>
<p>The
<span class="code">flip::FindMask_CUR</span> 
is sometimes used in a model change to just
iterate over elements that will be resident after the model change.</p>
<p>When injected from a
<span class="code">document_changed</span> 
the iterator will have the property of
iterating only over added or resident objects, and in particular
<strong>not over</strong> objects which are going to be
removed after a
<span class="code">document_changed</span> 
call.</p>
<p>When injected outside a
<span class="code">document_changed</span> 
the iterator will have the property
of iterating over all the elements (which are all residents)</p>
<h2><a name="ancestor">Visiting Ancestors</a></h2>
<p>Since every object of the model has one and only one parent except root which has
no parent, it is possible to navigate through each parent, recursively, until
the root object is reached. All those parents are called ancestors below.</p>
<p>Each Flip object supports the
<span class="code">get_ancestor</span> 
method which allow to grab
an ancestor by type.</p>
<div class="codeblock">
<table>
<tr><td><pre>SomeAncestorClass & ancestor = element.get_ancestor &lt;SomeAncestorClass&gt; ();</pre></td></tr>
</table>
</div>
<p>In practice, the
<span class="code">get_ancestor</span> 
function is very often used in the model code,
or the model client code.</p>
<div class="note"><p><strong>Note:</strong>Fetching the root class is always possible and safe.</p></div>


<div class="nav" align="right"><a href="ohm.flip.guide.cue.html">previous</a><span>&nbsp;</span><a href="ohm.flip.guide.observer.html">next</a></div>

<div class="bottomspacer">&nbsp;</div>

</div>

<footer>
<a href="index.html">Ohm Force Developer Library</a> > <a href="ohm.flip.guide.about.html">Flip Programming Guide</a> > <a href="ohm.flip.guide.navigation.html">Navigating the Model</a>
</footer>


</body>

</html>