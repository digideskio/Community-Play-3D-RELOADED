<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Flip Overview: How it Works</title>
<link rel="stylesheet" href="docpage.css" type="text/css" />
</head>

<script type="text/javascript">
function searchfield_focus(obj)
{
obj.style.color="#000"
if (obj.value=="Search Library")
	{obj.value=""}
}
</script>


<body>

<div id="header">
<div style="width: 1006px;">
<!--<form method="get" class="search" style="padding-top: 5px;"  action="http://www.google.com/search">
<input onfocus="searchfield_focus(this)" type="search" class="search" name="q" value="Search Library">
<input type="hidden" name="sitesearch" value="">
</form>-->
</div>
<p><a href="index.html">Ohm Force Developer Library</a><a href="ohm.flip.overview.about.html">Flip Overview</a></p>
</div>

<div id="toc">
<p>Flip Overview</p>
<ul>
<li><a href="ohm.flip.overview.about.html">About Flip</a></li>
<li><a href="ohm.flip.overview.how.html"><strong>How it Works</strong></a>
	<ul>
	<li><a href="ohm.flip.overview.how.html#build">Building a Transaction</a></li>
	<li><a href="ohm.flip.overview.how.html#validation">Validation</a></li>
	<li><a href="ohm.flip.overview.how.html#approval">Validation Approval</a></li>
	<li><a href="ohm.flip.overview.how.html#refusal">Validation Refusal</a></li>
	</ul>
</li>
<li><a href="ohm.flip.overview.model.html">Interfacing with the Model</a></li>
<li><a href="ohm.flip.overview.undo.html">Undo/Redo System</a></li>
<li><a href="ohm.flip.overview.threading.html">Threading System</a></li>
<li><a href="ohm.flip.overview.document.html">Document Format, Conversion</a></li>
</ul>

<div class="bottomspacer">&nbsp;</div>
</div>

<div id="content">

<div class="nav" align="right"><a href="ohm.flip.overview.about.html">previous</a><span>&nbsp;</span><a href="ohm.flip.overview.model.html">next</a></div>

<h1>How it Works</h1>

<h2><a name="build">Building a Transaction</a></h2>
<p>The client of the Flip framework will directly modify the model by either :</p>
<ul>
<li>modifying a value by assigning it
</li>
<li>insert a new object in a container
</li>
<li>erase an object from a container
</li>
</ul>
<center><img src="ohm.flip.overview.how.asm.png" /></center>
<p>Assigning a value is done with the
<span class="code">operator =</span> 
and modifying a container
follows the same kind of prototypes as found in the standard library 
(
<span class="code">insert</span> 
,
<span class="code">erase</span> 
, etc.) which makes the use of Flip quite natural.</p>
<p>In the background, each operation is translated in real-time in a simple
assembler. When the client of the library manipulate the model, Flip will apply and record
all the changes made to the model and will make a program in that assembler.</p>
<p>This program is also a transaction in the sense that applying a transaction
will transform the model from a valid state to another valid state.</p>
<h2><a name="validation">Validation</a></h2>
<p>This transaction is then sent to the server. The server will interpret the
assembler to make the changes to its own model. The transaction is then
validated by the server. Validation ensure that the model is consistent and
is done in two steps :</p>
<ol>
<li>structural validation
</li>
<li>logical validation
</li>
</ol>
<center><img src="ohm.flip.overview.how.valid.png" /></center>
<h3><a name="validation.structural">Structural Validation</a></h3>
<p>Structure validation is handled by Flip. It ensures that an object can be
either modified, inserted or erased.
For example structure validation may fail if two clients tries to erase an
object concurrently. In that case the second transaction is rejected.
Another example would be to reject a transaction where a client tries to
change a value of an object that was erased concurrently.</p>
<h3><a name="validation.logical">Logical Validation</a></h3>
<p>Logical validation is handled by the client. It ensures that the model
is consistent relative to the meaning that the the client assign virtually
to the model structures. For example the client might want to ensure that
for a container which the client assign the meaning of length, that its
element which could be defined with a position and length do not go passed
the length of container, that is to ensure :</p>
<div class="codeblock">
<table>
<tr><td><pre>element._position + element._length &lt;= container._length</pre></td></tr>
<tr><td><pre>0 &lt;= element._position</pre></td></tr>
<tr><td><pre>0 &lt;= element._length</pre></td></tr>
<tr><td><pre>0 &lt;= container._length</pre></td></tr>
</table>
</div>
<center><img src="ohm.flip.overview.how.valid.logic.png" /></center>
<p>This kind of validation is possible in Flip, as it is dynamic (it is a
program that the client writes) rather than static or semi-static
(like a XML/DTD)</p>
<p>The architecture of Flip allows to write validators very quickly, in a tree
parsing fashion.</p>
<h2><a name="approval">Validation Approval</a></h2>
<center><img src="ohm.flip.overview.how.valid.ok.png" /></center>
<p>When the two staged validation is good, the transaction is considered as
accepted. The server will broadcast the transaction for execution to the
other clients, and will send an approval to the original client.</p>
<h2><a name="refusal">Validation Refusal</a></h2>
<center><img src="ohm.flip.overview.how.valid.fail.png" /></center>
<p>When the two stages validation is wrong, the transaction is considered
as refused. The server will send a disapproval to the original client
which will rollback the transaction.</p>
<p>When another client execute the transaction, it will make all the changes
needed by that transaction. When it is done and succesfully applied,
the client observers are called.</p>


<div class="nav" align="right"><a href="ohm.flip.overview.about.html">previous</a><span>&nbsp;</span><a href="ohm.flip.overview.model.html">next</a></div>

<div class="bottomspacer">&nbsp;</div>

</div>

<footer>
<a href="index.html">Ohm Force Developer Library</a> > <a href="ohm.flip.overview.about.html">Flip Overview</a> > <a href="ohm.flip.overview.how.html">How it Works</a>
</footer>


</body>

</html>